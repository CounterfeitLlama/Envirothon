<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
        <script src="/__/firebase/4.12.1/firebase-app.js"></script>
        <script src="/__/firebase/4.12.1/firebase.js"></script>
        <script src="/__/firebase/4.12.1/firebase-firestore.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyBaiaR31dt4LsEU7U8E17NkGfCpMBkMzIU",
            authDomain: "envirothon-48dfa.firebaseapp.com",
            databaseURL: "https://envirothon-48dfa.firebaseio.com",
            projectId: "envirothon-48dfa",
            storageBucket: "envirothon-48dfa.appspot.com",
            messagingSenderId: "202201538676"
        };
        firebase.initializeApp(config);

        // Initialize Cloud Firestore through Firebase
        var db = firebase.firestore();
    </script>
    <title>Login</title>
</head>

<body>
    <h2>Login</h2>
    <div>
        <div class="form-group">
            <label for="email">Email address:</label>
            <input type="email" class="form-control" id="email">
        </div>
        <div class="form-group">
            <label for="pwd">Password:</label>
            <input type="password" class="form-control" id="password">
        </div>
        <button class="btn btn-default" onclick="auth()">Submit</button>
    </div>
    <button action="forgotpassword.html">Forgot Password?</button>
    <a href ="signup.html">Sign Up</a>
</body>
<script type="text/javascript">
    function auth() {
        var email = document.getElementById("email").value;
        var password = document.getElementById("password").value;
        console.log(email)
        console.log(password)
        firebase.auth().signInWithEmailAndPassword(email, password).then(function() {
            window.location.href = "index.html"
        }).catch(function(error) {
            // Handle Errors here.
            var errorCode = error.code;
            var errorMessage = error.message;
            console.log(error.code);
            console.log(error.message)
            // ...
        });
    };
</script>

<script type="text/javascript">
    firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
            var displayName = user.displayName;
            var email = user.email;
            var emailVerified = user.emailVerified;
            var photoURL = user.photoURL;
            var isAnonymous = user.isAnonymous;
            var uid = user.uid;
            var providerData = user.providerData;
            window.location.href = "index.html"

            // console.log(db.collection("users").doc(user.uid).data())
            var docRef = db.collection("users").doc(user.uid);

            docRef.get().then(function(doc) {
                if (doc.exists) {
                    console.log("Document data:", doc.data());
                } else {
                    // doc.data() will be undefined in this case
                    console.log("No such document!");
                }
            }).catch(function(error) {
                console.log("Error getting document:", error);
            });
        }
    });
</script>

</html>
